<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ALox: Pruning ALox Code in C# from Release Builts</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!-- so strange, that doxgen does not highlight each menu item. Just some... -->
<script>
  $(document).ready(function() {     
    fnameStart= window.location.href.lastIndexOf('/')
    fnameEnd=   window.location.href.indexOf('_', fnameStart )
    if( fnameEnd < 0 ) {
        fnameEnd=   window.location.href.indexOf('.', fnameStart )
    }
    if( fnameEnd > -1 ) {
        subString= window.location.href.substring( fnameStart, fnameEnd )
        $('li').toArray().forEach(function(li){
            if(     typeof li.firstChild.href != 'undefined'
                &&  li.firstChild.href.indexOf(subString) > 0 
                ){
               li.classList.add('current');
            }
        });
    }
  });
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="aworx_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="A-Worx-Logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ALox
   &#160;<span id="projectnumber">V. 1604 R. 1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../index.html"><span>ALox&#160;Home</span></a></li>
      <li><a href="../faq.html"><span>FAQ</span></a></li>
      <li><a href="../manual.html"><span>Manual</span></a></li>
      <li><a href="../cpp_ref/cppmainpage.html"><span>ALox&#160;for&#160;C++</span></a></li>
      <li class="current"><a href="csmainpage.html"><span>ALox&#160;for&#160;C#</span></a></li>
      <li><a href="../java_ref/javamainpage.html"><span>ALox&#160;for&#160;Java</span></a></li>
      <li><a href="../tools.html"><span>Tools</span></a></li>
      <li><a href="https://github.com/AlexWorx/ALox-Logging-Library"><span>Download</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="csmainpage.html"><span>Overview</span></a></li>
      <li><a href="cstutorial.html"><span>Tutorial</span></a></li>
      <li><a href="cssetup.html"><span>IDE&#160;Setup</span></a></li>
      <li><a href="cspruning.html"><span>Pruning&#160;ALox</span></a></li>
      <li><a href="annotated.html"><span>Class&#160;Reference</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Pruning ALox Code in C# from Release Builts </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#cssetup_pruning_what_is_pruning">1. What is Pruning?</a></li>
<li class="level1"><a href="#cssetup_pruning_how">2. How Pruning in ALox for C# works</a></li>
<li class="level1"><a href="#cssetup_pruning_result">3. Mission accomplished: Perfect Auto Pruning with ALox!</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="cssetup_pruning_what_is_pruning"></a>
1. What is Pruning?</h1>
<p>An introduction to the concept of pruning is given in <a href="../faq.html#faq_pruning">FAQ: What is Pruning?</a>.</p>
<h1><a class="anchor" id="cssetup_pruning_how"></a>
2. How Pruning in ALox for C# works</h1>
<p>Since Version 5, the Microsoft C# compiler supports methods to be annotated with class "ConditionalAttribute". This attribute uses a conditional compilation symbol which causes the compiler to ignore the invocation of methods when the symbol is not set. Again: the <em>invocation</em> of the methods is disabled, not the compilation of the methods itself!</p>
<p>Consider the following line of code:</p>
<div class="fragment"><div class="line">Log.SetVerbosity( <span class="keyword">new</span> ConsoleLogger() );</div></div><!-- fragment --><p>Method Log.SetVerbosity() is annotated as conditional using the symbol <em>ALOX_DBG_LOG</em>. Now the compiler does not include this line into the executable when <em>ALOX_DBG_LOG</em> is not set.</p>
<p>However, the compiler still checks the integrity of the parameter. Therefore, ALox provides empty method stubs for the most common classes and a few of their methods, even in the release configuration. To be able to compile the sample above in release mode, we need</p>
<ul>
<li>a class ConsoleLogger</li>
<li>a constructor of class ConsoleLogger taking a String object</li>
</ul>
<p>In the release version, both are empty "stubs" of their original classes. The reason why ALox creates stubs is to minimize the footprint of ALox in the moment it is not used (in the deployed applications that do not do release logging). Members of classes that are not too frequently used are not available in the release.</p>
<p>Consider the following code to setup the format of a log line:</p>
<div class="fragment"><div class="line">ConsoleLogger cl= <span class="keyword">new</span> ConsoleLogger();</div><div class="line">cl.MetaInfo.Format= <span class="keyword">new</span> AString( <span class="stringliteral">&quot;%SF(%SL):%SM()%A3[%DD][%TD][%TC +%TL]%V[%D]&lt;%#&gt;: &quot;</span>);</div><div class="line">Log.SetVerbosity( cl, <a class="code" href="namespacecs_1_1aworx_1_1lox.html#abf3be10d03894afb391f3a2935e3b313">Verbosity</a>.Verbose );</div></div><!-- fragment --><p>This would lead to a compilation error in the release configuration of your project (if you do not use release logging). The reason is, that the field <em>MetaInfo</em> is not included in the release version of ALox. In fact, the whole class <em>MetaInfo</em> is not existing!</p>
<p>To resolve this, use conditional compilation for all non-standard code specific to ALox logging:</p>
<div class="fragment"><div class="line">ConsoleLogger cl= <span class="keyword">new</span> ConsoleLogger();</div><div class="line"><span class="preprocessor">#if ALOX_DBG_LOG</span></div><div class="line">    cl.MetaInfo.Format= <span class="keyword">new</span> AString( <span class="stringliteral">&quot;%SF(%SL):%SM()%A3[%DD][%TD][%TC +%TL]%V[%D] &lt;%#&gt;: &quot;</span>);</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"><span class="preprocessor">Log.SetVerbosity( cl, Verbosity.Verbose  );</span></div></div><!-- fragment --><p>While this is sufficient, in the last sample, when compiled in release configuration, there is an almost empty version of ConsoleLogger still created and never used. Therefore, you might want to do it like this:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#if ALOX_DBG_LOG</span></div><div class="line">    ConsoleLogger cl= <span class="keyword">new</span> ConsoleLogger();</div><div class="line">    cl.MetaInfo.Format= <span class="keyword">new</span> AString( <span class="stringliteral">&quot;%SF(%SL):%SM()%A3[%DD][%TD][%TC +%TL]%V[%D] &lt;%#&gt;: &quot;</span>);</div><div class="line">    Log.SetVerbosity( cl, <a class="code" href="namespacecs_1_1aworx_1_1lox.html#abf3be10d03894afb391f3a2935e3b313">Verbosity</a>.Verbose );</div><div class="line"><span class="preprocessor">#endif</span></div></div><!-- fragment --><p>This sample shows, that only for the configuration/bootstrap part your code gets "cluttered" with <code>#if</code> <code></code>... <code>#endif</code> statements. And: As long as you do not get compiler errors in the release version, you can trust ALox that the impact of remaining configuration code is minimal. Again: standard logging code is always removed 100%!</p>
<h1><a class="anchor" id="cssetup_pruning_result"></a>
3. Mission accomplished: Perfect Auto Pruning with ALox!</h1>
<p>The result of the things said above incorporate <b>six great news</b> for you:</p>
<ol type="1">
<li>You can safely use most methods of class <em>Log</em> without enclosing them by <code>#if</code> <code></code>... <code>#endif</code> statements!</li>
<li>The impact of using ALox debug <em>Log Statements</em> in respect to execution speed in the release version of your application is exactly ZERO, because the methods do not make it into your release executable!</li>
<li>The impact of using ALox in respect to the footprint of your executable extremely small (all that remains are some empty classes with a few stubs). This remains true, even if thousands of new features would come in future versions of ALox!</li>
<li>All debug <em>Log Statements</em>, including all textual messages you are adding to your log calls, are completely pruned from the release executable! Your "debug secrets" can not be reverse engineered, they are just gone!</li>
<li>You do not need to clutter your code with <code>#if</code> <code></code>... <code>#endif</code> statements if using ALox! Only within some "bootstrap sections".</li>
<li>Even if you mix debug and release logging features of ALox the above stays true, except that the footprint of the ALox library is a little higher (e.g. it is 50kb in V1.1.0) !</li>
</ol>
<dl class="section note"><dt>Note</dt><dd>This is all true for C#. For other platforms check out platform specific sections of ALox pruning techniques. </dd></dl>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu May 26 2016 13:01:46 for ALox by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
