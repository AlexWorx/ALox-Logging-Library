<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ALox: Setup your IDE for Java Projects</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!-- so strange, that doxgen does not highlight each menu item. Just some... -->
<script>
  $(document).ready(function() {     
    fnameStart= window.location.href.lastIndexOf('/')
    fnameEnd=   window.location.href.indexOf('_', fnameStart )
    if( fnameEnd < 0 ) {
        fnameEnd=   window.location.href.indexOf('.', fnameStart )
    }
    if( fnameEnd > -1 ) {
        subString= window.location.href.substring( fnameStart, fnameEnd )
        $('li').toArray().forEach(function(li){
            if(     typeof li.firstChild.href != 'undefined'
                &&  li.firstChild.href.indexOf(subString) > 0 
                ){
               li.classList.add('current');
            }
        });
    }
  });
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="aworx_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="A-Worx-Logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ALox
   &#160;<span id="projectnumber">V. 1602 R. 1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../index.html"><span>ALox&#160;Home</span></a></li>
      <li><a href="../faq.html"><span>FAQ</span></a></li>
      <li><a href="../manual.html"><span>Manual</span></a></li>
      <li><a href="../cpp_ref/cppmainpage.html"><span>ALox&#160;for&#160;C++</span></a></li>
      <li><a href="../cs_ref/csmainpage.html"><span>ALox&#160;for&#160;C#</span></a></li>
      <li class="current"><a href="javamainpage.html"><span>ALox&#160;for&#160;Java</span></a></li>
      <li><a href="../tools.html"><span>Tools</span></a></li>
      <li><a href="https://github.com/AlexWorx/ALox-Logging-Library"><span>Download</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="javamainpage.html"><span>Overview</span></a></li>
      <li><a href="javatutorial.html"><span>Tutorial</span></a></li>
      <li><a href="javasetup.html"><span>IDE&#160;Setup</span></a></li>
      <li><a href="annotated.html"><span>Class&#160;Reference</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Setup your IDE for Java Projects </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#javasetup_1">1. Setting up your IDE</a><ul><li class="level2"><a href="#javasetup_download">1.1 Download</a></li>
<li class="level2"><a href="#javasetup_eclipse">1.2. For Eclipse Users: Link one of the following projects into your solution</a></li>
<li class="level2"><a href="#javasetup_addingsource">1.3 Alternatively: Adding source code to your project</a></li>
<li class="level2"><a href="#javasetup_testnow">1.4 Test your setup</a></li>
</ul>
</li>
<li class="level1"><a href="#javasetup_pruning">2. Pruning ALox Code in Java</a><ul><li class="level2"><a href="#javasetup_pruning_what_is_pruning">2.1 What is Pruning?</a></li>
<li class="level2"><a href="#javasetup_pruning_basics">2.1 How Pruning in ALox for Java works</a></li>
<li class="level2"><a href="#javasetup_pruning_breadth">2.2 What to Prune</a></li>
<li class="level2"><a href="#javasetup_pruning_proguard_platforms">2.3.1 ProGuard configuration for different platforms</a></li>
<li class="level2"><a href="#javasetup_pruning_proguard_config_standard">2.3.1 ProGuard configuration for standard Java</a></li>
<li class="level2"><a href="#javasetup_pruning_proguard_config_android">2.3.1 ProGuard configuration for Android</a></li>
<li class="level2"><a href="#javasetup_pruning_obfuscating">2.4 Obfuscating the code</a></li>
<li class="level2"><a href="#javasetup_pruning_result">2.5 Mission accomplished: Perfect Auto Pruning of ALox code!</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="javasetup_1"></a>
1. Setting up your IDE</h1>
<p>To use ALox logging in your Java project, some few preparatory steps have to be taken.</p>
<p>Currently, there is no binary distribution of ALox for Java available. Therefore, the way to incorporate ALox into your project is to include the sources. There are two options:</p>
<ul>
<li>add one of the existing ALox class library projects (Eclipse) to your solution, or</li>
<li>add ALox sources directly to your project.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>If you do not actually have a Java project (or do not want to touch one now) and you just want to have a first look into ALox, then create a new Java project in your IDE. Be sure to create an executable and that the typical "hello world" sample prints to the console.</dd></dl>
<h2><a class="anchor" id="javasetup_download"></a>
1.1 Download</h2>
<p>Unpack the ALox distribution (e.g. as zip) from <a href="https://github.com/AlexWorx/ALox-Logging-Library">Alox at GitHub</a> and move all its contents to a place where you safely store 3rd party libraries.</p>
<p>We call this folder the <em>ALOX_LIB_PATH</em>. Within the folder you should find at least the following subfolders: </p><pre class="fragment">    ALOX_LIB_PATH\src.java
    ALOX_LIB_PATH\build
    ALOX_LIB_PATH\html
</pre><p><br />
 </p>
<h2><a class="anchor" id="javasetup_eclipse"></a>
1.2. For Eclipse Users: Link one of the following projects into your solution</h2>
<p>To incorporate ALox into Eclipse, you will find the following ready to use projects in <em>ALOX_LIB_PATH</em>:</p>
<ul>
<li>Eclipse V.4.4 (Luna) project, standard (Desktop) Java with Java compiler 1.6 <pre class="fragment">  ALOXLIBPATH/build/ide.java.eclipse.luna/ALox-Java-1.6
</pre></li>
<li>Eclipse V.4.4 (Luna) project for Android development <pre class="fragment">  ALOXLIBPATH/build/ide.java.eclipse.luna/ALox-Java-Android
</pre></li>
</ul>
<p>If there is no appropriate predefined project available for you, skip the next section and continue reading <a class="el" href="javasetup.html#javasetup_addingsource">1.3 Alternatively: Adding source code to your project</a>.</p>
<p>Otherwise, its just two quick steps:</p>
<p><b>Step 1:</b> Import the predefined project into your eclipse workspace. Steps are:</p>
<ul>
<li>Open Eclipse with the workspace that contains the project(s) that you want to enrich with ALox logging</li>
<li>In Eclipse main menu, choose "File" / "Import"</li>
<li>From the dialog choose "General" / "Existing Projects into Workspace"</li>
<li>Press next and provide the root directory as appropriate (see list above)</li>
<li>Continue the Wizard as needed.</li>
</ul>
<p>You should have the project now incorporated into your workspace without any compiler errors.</p>
<dl class="section note"><dt>Note</dt><dd>The Java sources were coded using Eclipse with quite a high warning level setting. This led to the need to add some code annotations to suppress some warnings. If your Eclipse warning level setting is lower but now you get warnings on unnecessary code annotations (because the suppress warnings are not necessary in your environment), you can get rid of these messages by opening the Eclipse Preferences "Window/Preferences", Section "Java/Compiler/Errors/Warnings". Here, in the "Annotations" section, set "Unused '@SuppressWarnings' token:" to "Ignore".</dd></dl>
<p><b>Step 2:</b> Set a build dependency from your project to the just added <em>ALox-Java-xxx</em> project. Steps are:</p>
<ul>
<li>right click your project in Eclipse "Project Explorer" and choose "Properties"</li>
<li>In section "Java Build Path" go to the tab named "Projects"</li>
<li>Press the "Add..." button and tick "ALox-Java"</li>
<li>For the Android projects: Also set the ALox project for Android as a library in the "Android" section of the project properties.</li>
</ul>
<h2><a class="anchor" id="javasetup_addingsource"></a>
1.3 Alternatively: Adding source code to your project</h2>
<p>If there is no pre-defined project provided that suits your IDE (or needs), then you might want to add the ALox source code directly to your project or to a library project that you may want to create to separate the ALox code from your code. It should be fairly easy. The Java sources found in: </p><pre class="fragment">    ALOXLIBPATH/src.java/alib
    ALOXLIBPATH/src.java/alox
</pre><p>need to be compiled into your project.<br />
 </p><dl class="section note"><dt>Note</dt><dd>It is a good idea, to not copy the code, but to add the sources as links to their original place where you unpacked ALox. In Eclipse (Luna), linking source folders is found under "Project Properties", "Java Build Path", tab "Source" and then button "Link Source". The advantage of linking the source folders is that updating the source (e.g. with Git) updates them in your projects as well. Furthermore, if you might want to push your fixes or improvements to us using Git, the sources in the original folder need to be modified by you.</dd></dl>
<p>For <b>Android</b>, ALox provides a dedicated logger class that supports Android LogCat outputs. Therefore, to support Android projects, this logger class has to be added to your Android project (or Android ALox library project) into your project. For Android, in addition add folder: </p><pre class="fragment">    ALOXLIBPATH/src.java/alox.android
</pre><p>To stream ALox logging into LogCat create a logger of type <a class="el" href="classcom_1_1aworx_1_1lox_1_1android_1_1AndroidLogCatLogger.html">AndroidLogCatLogger</a> instead of type <a class="el" href="classcom_1_1aworx_1_1lox_1_1loggers_1_1ConsoleLogger.html">ConsoleLogger</a> as follows:</p>
<div class="fragment"><div class="line">Log.setVerbosity( <span class="keyword">new</span> AndroidLogCatLogger(<span class="stringliteral">&quot;LogCat&quot;</span>), Verbosity.VERBOSE );</div></div><!-- fragment --><p>Attention: The normal <a class="el" href="classcom_1_1aworx_1_1lox_1_1loggers_1_1ConsoleLogger.html">ConsoleLogger</a> will not produce any visible output using the Android Emulator or a debugging device.</p>
<h2><a class="anchor" id="javasetup_testnow"></a>
1.4 Test your setup</h2>
<p>To test your setup, add minimum ALox functionality to your project as described in the first chapter of <a class="el" href="javatutorial.html">ALox for Java Tutorial</a> into your main method or anywhere you think it is appropriate:</p>
<div class="fragment"><div class="line">    Log.addDebugLogger();</div><div class="line"></div><div class="line">    Log.removeDebugLogger();</div><div class="line">    Log.setVerbosity( tutLog= <span class="keyword">new</span> MemoryLogger( <span class="stringliteral">&quot;Tutlog&quot;</span> ), Verbosity.VERBOSE );</div><div class="line"></div><div class="line">    Log.addDebugLogger();</div><div class="line">    Log.info( <span class="stringliteral">&quot;Hello ALox&quot;</span> );</div></div><!-- fragment --><h1><a class="anchor" id="javasetup_pruning"></a>
2. Pruning ALox Code in Java</h1>
<h2><a class="anchor" id="javasetup_pruning_what_is_pruning"></a>
2.1 What is Pruning?</h2>
<p>An introduction to the concept of pruning is given in <a href="../faq.html#faq_pruning">FAQ: What is Pruning?</a>.</p>
<h2><a class="anchor" id="javasetup_pruning_basics"></a>
2.1 How Pruning in ALox for Java works</h2>
<p>Unfortunately, Java does not provide conditional compiler statements. (For example, the languages C, C++ and C# allow <code>#if</code> <code></code>... <code>#endif</code> statements and C#, since Version 5, supports methods to be annotated to be pruned, which is very handy!)<br />
 Therefore, in Java we have to work with a tool that operates on the compiled class files and prunes everything that the tool is configured for in a separated release build step.<br />
 For this manual, we decided to work with <a href="http://proguard.sourceforge.net">ProGuard</a>. The advantages that <em>ProGuard</em> offers are:</p>
<ul>
<li>It is open source and free to use.</li>
<li>Well established in the industry and incorporated into various professional development platforms. It is also a part of the Android SDK. Therefore, Android developers have <em>ProGuard</em> already installed on their developer machines.</li>
<li>Besides pruning, <em>ProGuard</em> can be configured to obfuscate your code (see <a href="http://proguard.sourceforge.net/#FAQ.html">ProGuard FAQ</a>).</li>
<li>Pruning is a part of the <em>ProGuard</em> optimization feature and these optimizations are very effective and beneficial for the performance of your application and the size (footprint) of your executable or library.</li>
</ul>
<p>The disadvantages are:</p><ul>
<li>A separated release built step has to be incorporated into your build process.</li>
<li>Due to the optimization features of <em>ProGuard</em>, the resulting code has to be tested extensively. (Sometimes <em>ProGuard</em> can corrupt your executable.)</li>
<li>If you choose to also obfuscate your code (not needed for pruning!) then debugging the release versions of your software gets very tough. Also stack traces from exceptions are only readable using a dedicated <em>ProGuard</em> tool.</li>
</ul>
<h2><a class="anchor" id="javasetup_pruning_breadth"></a>
2.2 What to Prune</h2>
<p>There are two possible configurations that differ in the breadth of pruning:</p><ul>
<li><em>Pruning with release logging enabled</em><br />
 This is the configuration you need if just your debug <em>Log Statements</em> are to be pruned. Use this, if you use ALox to perform some release logging.</li>
<li><em>Pruning all ALox code</em><br />
 This is the configuration you need to prune just all ALox code out of your library or executable. Use this, if you exclusively use ALox for debug logging purposes.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>For quick information on the terms "debug and release logging", <a href="../faq.html#faq_debug_vs_release_logging">read the FAQ</a>. <br />
 </dd></dl>
<dl class="section user"><dt></dt><dd></dd></dl>
<dl class="section note"><dt>Note</dt><dd>For debug logging, you should build your message strings using class <a class="el" href="classcom_1_1aworx_1_1lox_1_1LogBuf.html">LogBuf</a> and preferably the singleton of that acquired with method <a class="el" href="classcom_1_1aworx_1_1lox_1_1Log.html#a53c5060b0096f40c1001f96ff7ba80de">Log.buf()</a>. <br />
 See <a class="el" href="javatutorial.html#tutjava_logbuf">Using the log buffer singleton</a> for more information on how to use this.<br />
 Otherwise some remainders of unused strings and string concatenation code might remain. This is because ProGuard removes the method calls but not ultimately all parameter creation code of such method invocations. Using class <em>LogBuf</em> you are sure that this gets pruned.<br />
 While class <em>LogBuf</em> is only available in ALox for Java, your logging code will look the same as in other environments, because <em>LogBuf</em> mimics the interface of class <a class="el" href="classcom_1_1aworx_1_1lib_1_1strings_1_1AString.html">AString</a>.</dd></dl>
<h2><a class="anchor" id="javasetup_pruning_proguard_platforms"></a>
2.3.1 ProGuard configuration for different platforms</h2>
<p>Depending on your Java target platform, choose one of the following subchapters to read further:</p>
<ul>
<li><a class="el" href="javasetup.html#javasetup_pruning_proguard_config_standard">Standard Java, desktop and libraries</a></li>
<li><a class="el" href="javasetup.html#javasetup_pruning_proguard_config_android">Android Apps</a></li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The configuration provided here was tested with<ul>
<li>ProGuard Version 4.11, release, Dec. 2013</li>
<li>ProGuard Version 5.2, released Jan 2015</li>
</ul>
</dd></dl>
<h2><a class="anchor" id="javasetup_pruning_proguard_config_standard"></a>
2.3.1 ProGuard configuration for standard Java</h2>
<p>In the distribution folder of ALox, you will find a sample project in subfolder: </p><pre class="fragment">    ALOX_LIB_PATH/build/ide.java.eclipse.luna/ALox-Java-1.6-Test
</pre><p>Within this folder, you will find the different <em>ProGuard</em> sample configuration files:</p><ul>
<li>For pruning just the debug logging statements and enable release logging: <pre class="fragment">  proguard-prune-alox-debug.pro
</pre></li>
<li>For pruning ALox completely: <pre class="fragment">  proguard-prune-alox-all.pro
</pre></li>
</ul>
<p>Both files have the same start:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;### input/output ###</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;-injars ../ALox-Java-1.6/bin</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;-injars bin/ALoxSamples.class </div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;-outjars bin.pruned</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;### for testing ###</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;#-verbose</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;#-printusage</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;#-dontobfuscate</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;-optimizationpasses 5</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;-keepclasseswithmembers public class ALoxSamples</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;{</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    public static void main(java.lang.String[]);</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;}</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;# Pruning AWorx Library assertions and debug messages</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;-assumenosideeffects    class   com.aworx.lib.ALIB</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; {</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;     void ERROR         ( java.lang.String ) ;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;     void WARNING       ( java.lang.String ) ;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;     void ASSERT        ( boolean ) ;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;     void ASSERT_ERROR  ( boolean, java.lang.String ) ;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;     void ASSERT_WARNING( boolean, java.lang.String ) ;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; }</div></div><!-- fragment --><p>For your own projects, you have to modify the first lines starting with </p><pre class="fragment">    -injars...
</pre><p>to include your project code and library projects Then, the configuration that only prunes debug logging but leaves release logging in, continues as follows:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;# Pruning ALOX debug logging (release logging stays in)</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;-assumenosideeffects    class   com.aworx.lox.Log       { &lt;methods&gt;;  &lt;fields&gt;; }</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;-assumenosideeffects    class   com.aworx.lox.LogBuf    { &lt;methods&gt;;  &lt;fields&gt;; }</div></div><!-- fragment --><p> The other configuration file, that prunes just all ALox stuff continues like this:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;# Pruning ALOX completely (release logging as well as debug logging)</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;-assumenosideeffects    class   com.aworx.lox.*        { &lt;methods&gt;;  &lt;fields&gt;; }</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div></div><!-- fragment --><p> Both files then continue with other default <em>ProGuard</em> configuration code.</p>
<dl class="section note"><dt>Note</dt><dd>You can configure <em>ProGuard</em> the way you prefer, however, you must not disable the <em>optimization</em> step, as this is where <em>ProGuard</em> prunes ALox!</dd></dl>
<dl class="section user"><dt></dt><dd></dd></dl>
<dl class="section note"><dt>Note</dt><dd><em>ProGuard</em> supports <em>Ant Tasks</em> and <em>Gradle Tasks</em>. See the corresponding <em>ProGuard</em> documentation for details.</dd></dl>
<p><b>That all, you are set!</b></p>
<p>The test project distributed with ALox can be easily used to see what is happening using <em>ProGuard</em>. Go ahead as follows:</p><ul>
<li>Add the following two projects to Eclipse (or compile them with your favorite IDE): <pre class="fragment">  ALOX_LIB_PATH/build/ide.java.eclipse.luna/ALox-Java-1.6_ (if not done, yet)
  ALOX_LIB_PATH/build/ide.java.eclipse.luna/ALox-Java-1.6-Test
</pre></li>
<li>Make sure you have <em>ProGuard</em> installed (if you have Android SDK installed, you have <em>ProGuard</em>!)<br />
 It may be necessary to set the <code>PROGUARD_HOME</code> environment variable to the <em>ProGuard</em> path, e.g. <pre class="fragment">  PROGUARD_HOME=c:\\usr\\Dev\\Android\\android-sdk\\tools\\proguard
</pre></li>
<li>Open a command prompt (Windows) respectively a shell window (Linux)<br />
 It may be necessary to set the <code>JAVA_HOME</code> environment variable to your Java JDK or JRE, e.g. <pre class="fragment">  JAVA_HOME=C:\\Program Files\\Java\\jre6 (Windows OS)
  JAVA_HOME=/lib/jvm/java-7-openjdk/jre/  (Arch Linux)
</pre></li>
<li>cd into: <pre class="fragment">  ALOX_LIB_PATH/build/ide.java.eclipse.luna/ALox-Java-1.6-Test
</pre></li>
<li><p class="startli">Launch </p><pre class="fragment">  ./start-SimpleTests.[sh|bat]
</pre><p class="startli">and check the un-pruned output of the test</p>
</li>
<li>Launch <pre class="fragment">  ./proguard.prune-alox-debug.[sh|bat]
  ./start-SimpleTests-Pruned.[sh|bat]
</pre></li>
</ul>
<p>and check the output of the test with debug logging pruned</p><ul>
<li>Launch <pre class="fragment">  ./proguard.prune-alox-all.[sh|bat]
  ./start-SimpleTests-Pruned.[sh|bat]
</pre></li>
</ul>
<p>and check the output of the test with all logging pruned</p>
<dl class="section note"><dt>Note</dt><dd>If you look into the script files that invoke <em>ProGuard</em> (<code>proguard.prune-alox-debug</code>.[sh|bat] and <code>proguard.prune-alox-all</code>.[sh|bat]) you will see that the Java runtime library is passed as another parameter. This parameter might be moved into the <code>*</code>.pro configuration files as well. To have them here, seems more appropriate, as this way, the current Java environment activated on your machine is used.</dd></dl>
<h2><a class="anchor" id="javasetup_pruning_proguard_config_android"></a>
2.3.1 ProGuard configuration for Android</h2>
<p>As <em>ProGuard</em> is a part of the Android SDK, there is plenty of documentation and help found in the internet on how to configure <em>ProGuard</em> and how the post compilation step is included into the build system. A good start to read more deatils on this is found here: <a href="http://developer.android.com/tools/help/proguard.html">http://developer.android.com/tools/help/proguard.html</a>.</p>
<p>But the setup if fairly easy! On a fresh, new Android project (in Eclipse) the steps that have to be taken are the following:</p>
<ul>
<li>We start editing the file <code>project.properties</code>, found the root folder of your Eclipse project. At the end of the file, add the following lines: <br />
<br />
 <div class="fragment"><div class="line"><span class="preprocessor"># proguard</span></div><div class="line"><span class="preprocessor">proguard.config=${sdk.dir}/tools/proguard/proguard-android-optimize.txt:proguard-project.txt</span></div></div><!-- fragment --> <br />
 <em>Note: While the Android SDK documentation (see link above) does not really talk to much about it, the SDK provides an extended basic configuration file for <em>ProGuard</em>, that enables optimization of class files, hence enables pruning of ALox.</em> <br />
<br />
</li>
<li>Next, we edit the file <code>proguard-project.txt</code>, also found the root folder of your Eclipse project.<br />
<ul>
<li>If you want to enable release logging, at the end of the file, add the following lines: <br />
<br />
 <div class="fragment"><div class="line"><span class="preprocessor"># Pruning ALox debug logging (release logging stays in)</span></div><div class="line">-assumenosideeffects    <span class="keyword">class   </span><a class="code" href="namespacecom.html">com</a>.aworx.lox.Log       { &lt;methods&gt;;  &lt;fields&gt;; }</div><div class="line">-assumenosideeffects    <span class="keyword">class   </span><a class="code" href="namespacecom.html">com</a>.aworx.lox.LogBuf    { &lt;methods&gt;;  &lt;fields&gt;; }</div></div><!-- fragment --> <br />
</li>
<li>Alternatively, if you want to disable release logging (prune all ALox logging from your code), at the end of the file, add the following lines: <br />
<br />
 <div class="fragment"><div class="line"><span class="preprocessor"># Pruning ALox completely (release logging as well as debug logging)</span></div><div class="line"><span class="preprocessor">-assumenosideeffects    class   com.aworx.lox.**        { &lt;methods&gt;;  &lt;fields&gt;; }</span></div></div><!-- fragment --></li>
</ul>
</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Of-course you can also leave debug logging enabled in your release android app and still use <em>ProGuard</em> as intended by the Android SDK. For this, just do not put any of the above lines in the proguard-project.txt file.</dd></dl>
<p><b>This is all you need to do!</b></p>
<p>When "exporting" your application into an APK file, ALox gets automatically pruned by <em>ProGuard</em> and the Android SDK build process.</p>
<p>ALox provides a preconfigured sample project for Android:</p>
<p>Add the two following two projects to Eclipse (or compile them with your favorite IDE):</p><ul>
<li>_ALOX_LIB_PATH/build/ide.java.eclipse.luna/ALox-Java-Android (if not done, yet)</li>
<li>_ALOX_LIB_PATH/build/ide.java.eclipse.luna/ALox-Java-Android-Test-Release-Log</li>
</ul>
<p>You can <em>export</em> the APK file of the latter project in two variants: with release logging enabled or disabled. Modify <code>proguard-project.txt</code> accordingly and see what happens when you launch the APK on your device.</p>
<p>Also, you might want to have a quick look this projects sample code found in:</p>
<div class="fragment"><div class="line">ALOX_LIB_PATH/build/ide.java.eclipse.luna/ALox-Java-Android-Test-Release-Log/src/<a class="code" href="namespacecom.html">com</a>/aworx/alox_java_android_test_release_log/ALoxJavaAndroidTestReleaseLog.java</div></div><!-- fragment --><p>to get a first understanding of ALox release logging.</p>
<h2><a class="anchor" id="javasetup_pruning_obfuscating"></a>
2.4 Obfuscating the code</h2>
<p>As mentioned already, <em>ProGuard</em> provides an optional feature to obfuscate your code. Again, this is only optional and obfuscation has benefits but also some disadvantages. In respect to ALox, obfuscation introduces one little difficulty related to all methods that work with the "caller scope". Most remarkably, most Scope Domain setting will stop working, because packages, class names and file names get mangled heavily.<br />
 The implication is, that any release logging statements (debug log is not affected as this is either way pruned from your release binaries) must not use Scope Domains. In other words, for each invocation of a log call (again, only of release logging!) the <em>Log Domain</em> has to be explicitly set.</p>
<p>For release logging in combination with obfuscation, you might want to suppress the output of scope information in the log line (see <a class="el" href="classcom_1_1aworx_1_1lox_1_1core_1_1textlogger_1_1TextLogger.html#aad96483110212e8fa0d6a9490fcd2e02">TextLogger.metaInfo</a> for information on how to do that).</p>
<p>On the same token, the methods <a class="el" href="classcom_1_1aworx_1_1lox_1_1Lox.html#afd6a91bb2c6eaee017b0ccbd4cccd447">Lox.setDomain</a>, <a class="el" href="classcom_1_1aworx_1_1lox_1_1Lox.html#a3379a132338bd43fb84bd769dc1fd2c4">Lox.store</a>/ <a class="el" href="classcom_1_1aworx_1_1lox_1_1Lox.html#ab4159eca3fb8c6f996a46f22c2cc442a">retrieve</a> and <a class="el" href="classcom_1_1aworx_1_1lox_1_1Lox.html#a3379a132338bd43fb84bd769dc1fd2c4">Lox.once</a> will not work properly with language-related <em>Scopes</em> if you obfuscate. For more information on this, refer to the user manual chapters about <em>Scope Domains</em>, <em>Scopes</em> and features building on <em>Scopes</em>.</p>
<p>Finally, it is obvious that <a class="el" href="classcom_1_1aworx_1_1lox_1_1tools_1_1LogTools.html#adea42ddd53fb309518d7f4f48450dbde">LogTools.instance()</a> will not show readable results when your classes become obfuscated.</p>
<h2><a class="anchor" id="javasetup_pruning_result"></a>
2.5 Mission accomplished: Perfect Auto Pruning of ALox code!</h2>
<p>The result of the things said above incorporate <b>six great news</b> for you:</p>
<ol type="1">
<li>You can safely use all methods of classes <em>Log</em> and <em>LogTools</em> without any special treatment for pruning within your code.</li>
<li>The impact of using ALox debug <em>Log Statements</em> in respect to execution speed in the release version of your application is exactly ZERO, because the methods do not make it into your release executable!</li>
<li>The impact of using ALox in respect to the footprint of your executable extremely small (all that remains are some empty classes with a few stubs). This remains true, even if thousands of new features would come in future versions of ALox!</li>
<li>All debug <em>Log Statements</em>, including all textual messages you are adding to your log calls, are completely pruned from the release executable! Your "debug secrets" can not be reverse engineered, they are just gone!</li>
<li>Even if you mix debug and release logging features of ALox the above stays true, except that the footprint of the ALox library is a little higher (e.g. it is 50kb in V1.1.0) !</li>
</ol>
<dl class="section note"><dt>Note</dt><dd>This is all true for Java. For other platforms check out platform specific sections of ALox pruning techniques.</dd></dl>
<dl class="section user"><dt></dt><dd></dd></dl>
<dl class="section note"><dt>Note</dt><dd>The Android SDK documentation suggests to "remove all your logging code" releasing an Android app. From now on you can just ignore this advice! </dd></dl>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 19 2016 14:36:18 for ALox by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
