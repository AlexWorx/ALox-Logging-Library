<!-- HTML header for doxygen 1.8.12-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ALox: 15 - Log Domain Substitution</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="aworx_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="A-Worx-Logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ALox
   &#160;<span id="projectnumber">V. 1702 R. 1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--ALox Main Menu-->
<div style="background: #2f3a48; " >
<table  class="aworx-menutable"  >
 <tbody>
 <tr style="height: 36px;">
  <td> <a class="aworx-menu_hl" href="index.html"                  >Home</a>                        </td>
  <td> <a class="aworx-menu"    href="cpp_ref/cppmainpage.html"    >ALox for C++</a>                </td>
  <td> <a class="aworx-menu"    href="cs_ref/csmainpage.html"      >ALox for C#</a>                 </td>
  <td> <a class="aworx-menu"    href="java_ref/javamainpage.html"  >ALox for Java</a>               </td>
  <td> <a class="aworx-menu"    href="https://github.com/AlexWorx/ALox-Logging-Library">Download</a></td>
 </tr>
 </tbody>
</table>
</div>
<!--end ALox Main Menu-->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0"
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">15 - Log Domain Substitution </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="man_domain_substitution_intro"></a>
1. Introduction</h1>
<p><em>Domain Substitution</em> is a concept of <b>ALox</b> that allows to manipulate the effective domain of <em>Log Statements</em> without changing neither these statements nor the <em>Scope Domains</em> that apply to them. Therefore, <em>Domain Substitution</em> is useful when those changes can not be performed (e.g. because the corresponding <b>ALox</b> code is residing in a library) or because a temporary "redirect" of certain domains is wanted.</p>
<p>As with <em>Scope Domain</em> settings, the concept of <em>Domain Substitution</em> in general should not be 'overused'. Otherwise, things might get complicated.</p>
<p>The rules are set and removed with method <b>Lox.SetDomainSubstitutionRule</b> (<a class="elRef" doxygen="ALox/html/cpp_ref/cpp_ref.tag:./cpp_ref/" href="./cpp_ref/classaworx_1_1lox_1_1Lox.html#a29833c62d41ae3049594a81c7651dfdc">C++</a>, <a class="elRef" doxygen="ALox/html/cs_ref/cs_ref.tag:./cs_ref/" href="./cs_ref/classcs_1_1aworx_1_1lox_1_1Lox.html#a7b00366e6ea7fb2a4769abef6c243107">C#</a>, <a class="elRef" doxygen="ALox/html/java_ref/java_ref.tag:./java_ref/" href="./java_ref/classcom_1_1aworx_1_1lox_1_1Lox.html#a28c3f7dfb6142e509a46adbfbd309264">Java</a>), which accepts two parameters:</p><ul>
<li><code>domainPath:</code> <br />
 The domain path (substring) that is to be searched and replaced. For the search, a simple <em>'wildcard'</em> mechanism is aplied: It is allowed to use character <code> '*'</code> at the beginning and/or the end of the search string. As a result, four <em>'types'</em> of rules can be created<ul>
<li>Exact match (no <code>*</code> given)</li>
<li>Prefix match (<code>*</code> at the end of <code>domainPath</code>)</li>
<li>Suffix match (<code>*</code> at the start of <code>domainPath</code>)</li>
<li>Substring match (<code>*</code> at both, start and the end of <code>domainPath</code>)</li>
</ul>
</li>
<li><code>replacement:</code> <br />
 This is the string that replaces the string in <code>domainPath</code> when the rule matches. If this is empty (or nulled), the rule is removed from the <b>Lox</b>.</li>
</ul>
<p>If for any reason, all rules should be deleted at once, invoke method <b>Lox.SetDomainSubstitutionRule</b> with providing a nulled or empty string for <code>domainPath</code>. There is no explicit other method for clearing the rules given, because the designers of <b>ALox</b> do not see a use case for doing this.</p>
<h1><a class="anchor" id="man_domain_substitution_processing"></a>
2. How Class Lox Processes the Rules</h1>
<p>Rules for <em>Domain Substitution</em> are applied after any other evaluation of the resulting domain is performed. The rules are applied in the order of their definition. Therefore, rules that are passed from configuration files (or command line, etc.) are applied first. Rules might influence each other, hide each oder or even be circular. When setting the rules, ALox does not check for such (sometimes wanted) dependencies of the rules. It might happen, that a rule that was defined earlier than a different one, would be effective only after the second rule was applied. Therefore, <b>ALox</b> repeats the application of all rules as long as at least one of the rules matched. Because of the possibility of having circular dependencies, a maximum amount of ten loops is performed. After that, <b>ALox</b> stops processing <em>Domain Substitution</em> and writes a <em>Log Statement</em> of <em>Verbosity.Error</em> to the internal domain. The error message is only issued once. However the flag is reset when all rules are cleared (by providing a nulled string value for parameter <code>domainPath</code> of method <b>Lox.SetDomainSubstitutionRule</b> (<a class="elRef" doxygen="ALox/html/cpp_ref/cpp_ref.tag:./cpp_ref/" href="./cpp_ref/classaworx_1_1lox_1_1Lox.html#a29833c62d41ae3049594a81c7651dfdc">C++</a>, <a class="elRef" doxygen="ALox/html/cs_ref/cs_ref.tag:./cs_ref/" href="./cs_ref/classcs_1_1aworx_1_1lox_1_1Lox.html#a7b00366e6ea7fb2a4769abef6c243107">C#</a>, <a class="elRef" doxygen="ALox/html/java_ref/java_ref.tag:./java_ref/" href="./java_ref/classcom_1_1aworx_1_1lox_1_1Lox.html#a28c3f7dfb6142e509a46adbfbd309264">Java</a>)).</p>
<p>This amount of loops should be more than enough for all major use cases. Even a third loop is necessary very seldom.</p>
<h1><a class="anchor" id="man_domain_substitution_config"></a>
3. Substitution Rules and External Configuration</h1>
<h2><a class="anchor" id="man_domain_substitution_config_using"></a>
3.1 Using External Configuration</h2>
<p>Setting <em>Domain Substitution Rules</em> <em>'from within the source code'</em> is easy and straightforward. However, when working in a team such changes might not be appreciated by other team members. In this and other situations it is advisable to retrieve <em>Domain Substitution Rules</em> from external configuration data, command-line parameters or other sources at runtime.</p>
<p>For <em>Domain Substitution Rules</em> and also other configuration data, <b>ALox</b> leverages the configuration facility provided by underlying utility library <b>ALib</b>.</p>
<dl class="section note"><dt>Note</dt><dd>For general information on <b>ALox</b> configuration variables consult <a class="el" href="group__GrpALoxConfigVars.html">I - Configuration Variables</a>.<br />
 For information on how to pass configuration data from custom sources to <b>ALox</b>, refer to namespace documentation <b>aworx::lib::config</b> (<a class="elRef" doxygen="ALox/html/cpp_ref/cpp_ref.tag:./cpp_ref/" href="./cpp_ref/namespaceaworx_1_1lib_1_1config.html">C++</a>, <a class="elRef" doxygen="ALox/html/cs_ref/cs_ref.tag:./cs_ref/" href="./cs_ref/namespacecs_1_1aworx_1_1lib_1_1config.html">C#</a>, <a class="elRef" doxygen="ALox/html/java_ref/java_ref.tag:./java_ref/" href="./java_ref/namespacecom_1_1aworx_1_1lib_1_1config.html">Java</a>).</dd></dl>
<p>The constructor of class <b>Lox</b> tries to read a configuration variable named <code>ALOX_LOXNAME_DOMAIN_SUBSTITUTION</code>. When setting the variable, the substring <code>'LOXNAME'</code> needs to be replaced by the name of the <b>Lox</b> in question. The variable itself may contain a list of <em>Domain Substitution Rules</em> separated by semicolons <code> ';'</code>. Each rule consists of two strings which correspond to the two parameters of method <b>Lox.SetDomainSubstitutionRule</b> (<a class="elRef" doxygen="ALox/html/cpp_ref/cpp_ref.tag:./cpp_ref/" href="./cpp_ref/classaworx_1_1lox_1_1Lox.html#a29833c62d41ae3049594a81c7651dfdc">C++</a>, <a class="elRef" doxygen="ALox/html/cs_ref/cs_ref.tag:./cs_ref/" href="./cs_ref/classcs_1_1aworx_1_1lox_1_1Lox.html#a7b00366e6ea7fb2a4769abef6c243107">C#</a>, <a class="elRef" doxygen="ALox/html/java_ref/java_ref.tag:./java_ref/" href="./java_ref/classcom_1_1aworx_1_1lox_1_1Lox.html#a28c3f7dfb6142e509a46adbfbd309264">Java</a>). These two strings are to be separated by <code>'-&gt;'</code>.</p>
<p>As an example, an INI file of an application might have the following sub-section:</p>
<div class="fragment"><div class="line">[ALOX]</div><div class="line">MYLOX_DOMAIN_SUBSTITUTION= /A_DOM -&gt; /BETTER_NAME   ; \</div><div class="line">                           /UI    -&gt; /LIBS/UI</div></div><!-- fragment --><p> With variable <code>ALOX_MYLOX_DOMAIN_SUBSTITUTION</code> set in the INI file, a <b>Lox</b> named <code>'MYLOX'</code> would receive the two rules specified.</p>
<h2><a class="anchor" id="man_domain_substitution_config_prevent"></a>
3.2 Preventing The Use Of External Configuration</h2>
<p>Sometimes it might be wanted that <em>Domain Substitution Rules</em> are not manipulable externally. A reason could be that by the nature of these rules, unauthorized users are enabled to change the <em>Log Domains</em> and hence also to change their <em>Verbosity</em>, which otherwise can be prevented for protection (see <a class="el" href="man_external_verbosity_configuration.html">13 - External Verbosity Configuration</a>).</p>
<p>ALox does not provide an explicit interface to prevent reading the rules from the configuration. The simple way out, is to delete all rules after the creation of the <b>lox</b>:</p>
<div class="fragment"><div class="line">myLox= <span class="keyword">new</span> <a class="codeRef" doxygen="ALox/html/cpp_ref/cpp_ref.tag:./cpp_ref/" href="./cpp_ref/classaworx_1_1lox_1_1Lox.html">Lox</a>( <span class="stringliteral">&quot;MyLox&quot;</span> );                      <span class="comment">// name will be converted to upper case</span></div><div class="line">myLox.SetDomainSubstitutionRule( null, null );  <span class="comment">// clear rules eventually read in constructor</span></div></div><!-- fragment --><h1><a class="anchor" id="man_domain_substitution_wrapup"></a>
4. Final Remarks</h1>
<p><em>Domain Substitution</em> rules are always applied to all <em>Loggers</em> within a <b>Lox</b>.</p>
<p>As noted already, <em>Domain Substitution</em> should be used with care and in case of doubt, thought well. Different alternatives to setting a <em>Domain Substitution</em> exist. For example, to manipulate the domain of methods executed within a library, a thread-related <em>Scope Domain</em> setting may be set prior to invoking library methods.</p>
<p><em>Prefix Logables</em> that have been set for a domain that gets substituted, of-course do <em>not</em> apply to the substitution domain. In contrast, a <em>Log Statement</em> whose resulting domain gets substituted works just as it was using the new domain within its invocation and <em>Scope Domain</em> setting. Therefore, <em>Domain Substitution</em> settings - if at all - should be made at the beginning of a processes life-cycle and then should not be altered. In this case, also <em>Prefix Logables</em> will be 'transferred' to the substitution domain, providing that the commands that are setting them use relative domain paths.</p>
<p><em>Domain Substitution</em> may not be used to substitute <em>Log Domains</em> of the standard domain tree with those of the internal tree or vice versa.</p>
<hr/>
 <center>Next chapter: <a class="el" href="man_colorful_loggers.html">16 - Colorful Loggers</a> </center> <center> <a class="el" href="manual.html">Back to index</a> </center> </div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.12-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 9 2017 16:16:29 for ALox by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
<!-- Start of StatCounter Code e -->
<script type="text/javascript">
var sc_project=11242602;
var sc_invisible=1;
var sc_security="5ac13373";
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="web statistics"
href="http://statcounter.com/" target="_blank"><img
class="statcounter"
src="//c.statcounter.com/11242602/0/5ac13373/1/" alt="web
statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
</body>
</html>
