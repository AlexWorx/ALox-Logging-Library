<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ALox: 14 - Log Domain Substitution</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!-- so strange, that doxgen does not highlight each menu item. Just some... -->
<script>
  $(document).ready(function() {     
    fnameStart= window.location.href.lastIndexOf('/')
    fnameEnd=   window.location.href.indexOf('_', fnameStart )
    if( fnameEnd < 0 ) {
        fnameEnd=   window.location.href.indexOf('.', fnameStart )
    }
    if( fnameEnd > -1 ) {
        subString= window.location.href.substring( fnameStart, fnameEnd )
        $('li').toArray().forEach(function(li){
            if(     typeof li.firstChild.href != 'undefined'
                &&  li.firstChild.href.indexOf(subString) > 0 
                ){
               li.classList.add('current');
            }
        });
    }
  });
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="aworx_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="A-Worx-Logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ALox
   &#160;<span id="projectnumber">V. 1602 R. 1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>ALox&#160;Home</span></a></li>
      <li><a href="faq.html"><span>FAQ</span></a></li>
      <li><a href="manual.html"><span>Manual</span></a></li>
      <li><a href="cpp_ref/cppmainpage.html"><span>ALox&#160;for&#160;C++</span></a></li>
      <li><a href="cs_ref/csmainpage.html"><span>ALox&#160;for&#160;C#</span></a></li>
      <li><a href="java_ref/javamainpage.html"><span>ALox&#160;for&#160;Java</span></a></li>
      <li><a href="tools.html"><span>Tools</span></a></li>
      <li><a href="https://github.com/AlexWorx/ALox-Logging-Library"><span>Download</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">14 - Log Domain Substitution </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><br />
 </p>
<h1><a class="anchor" id="man_domain_substitution_intro"></a>
1. Introduction</h1>
<p><em>Domain Substitution</em> is a concept of ALox that allows to manipulate the effective domain of <em>Log Statements</em> without changing neither these statements nor the <em>Scope Domains</em> that apply to them. Therefore, <em>Domain Substitution</em> is useful when those changes can not be performed (e.g. because the corresponding ALox code is residing in a library) or because the a temporary "redirect" of certain domains is wanted.</p>
<p>As with <em>Scope Domain</em> settings, the concept of <em>Domain Substitution</em> in general should not be 'overused'. Otherwise, things might get complicated.</p>
<p>The rules are set and removed with method <b>Lox.SetDomainSubstitutionRule</b> (<a class="elRef" doxygen="/A-Worx/ALox/html/cpp_ref/cpp_ref.tag:cpp_ref/" href="cpp_ref/classaworx_1_1lox_1_1Lox.html#a57e92057e7a33c93ff16a677df6db52b">C++</a>, <a class="elRef" doxygen="/A-Worx/ALox/html/cs_ref/cs_ref.tag:cs_ref/" href="cs_ref/classcs_1_1aworx_1_1lox_1_1Lox.html#ad02747a6295e7875c14a77996d9728cd">C#</a>, <a class="elRef" doxygen="/A-Worx/ALox/html/java_ref/java_ref.tag:java_ref/" href="java_ref/classcom_1_1aworx_1_1lox_1_1Lox.html#a28c3f7dfb6142e509a46adbfbd309264">Java</a> ), which accepts two parameters:</p><ul>
<li><code>domainPath:</code> <br />
 The domain path (substring) that is to be searched and replaced. For the search, a simple <em>'wildcard'</em> mechanism is aplied: It is allowed to use character <code> '*'</code> at the beginning and/or the end of the search string. As a result, four <em>'types'</em> of rules can be created<ul>
<li>Exact match (no <code>*</code> given)</li>
<li>Prefix match (<code>*</code> at the end of <code>domainPath</code>)</li>
<li>Suffix match (<code>*</code> at the start of <code>domainPath</code>)</li>
<li>Substring match (<code>*</code> at both, start and the end of <code>domainPath</code>)</li>
</ul>
</li>
<li><code>replacement:</code> <br />
 This is the string that replaces the string in <code>domainPath</code> when the rule matches. If this is empty (or nulled), the rule is removed from the <b>Lox</b>.</li>
</ul>
<p>If for any reason, all rules should be deleted at once, invoke method <b>Lox.SetDomainSubstitutionRule</b> with providing a nulled or empty string for <code>domainPath</code>. There is no explicit other method for clearing the rules given, because the designers of ALox do not see a use case for doing this.</p>
<h1><a class="anchor" id="man_domain_substitution_processing"></a>
2. How Class Lox Processes the Rules</h1>
<p>Rules for <em>Domain Substitution</em> are applied after any other evaluation of the resulting domain is performed. The rules are applied in the order of their definition. Therefore, rules that are passed from configuration files (or command line, etc.) are applied first. Rules might influence each other, hide each oder or even be circular. When setting the rules, ALox does not check for such (sometimes wanted) dependencies of the rules. It might happen, that a rule that was defined earlier than a different one, would be effective only after the second rule was applied. Therefore, ALox repeats the application of all rules as long as at least one of the rules matched. Because of the possibility of having circular dependencies, a maximum amount of ten loops is performed. After that, ALox stops processing <em>Domain Substitution</em> and writes a <em>Log Statement</em> of <em>Verbosity.Error</em> to the internal domain. The error message is only issued once. However the flag is reset when all rules are cleared (by providing a nulled string value for parameter <code>domainPath</code> of method <b>Lox.SetDomainSubstitutionRule</b> (<a class="elRef" doxygen="/A-Worx/ALox/html/cpp_ref/cpp_ref.tag:cpp_ref/" href="cpp_ref/classaworx_1_1lox_1_1Lox.html#a57e92057e7a33c93ff16a677df6db52b">C++</a>, <a class="elRef" doxygen="/A-Worx/ALox/html/cs_ref/cs_ref.tag:cs_ref/" href="cs_ref/classcs_1_1aworx_1_1lox_1_1Lox.html#ad02747a6295e7875c14a77996d9728cd">C#</a>, <a class="elRef" doxygen="/A-Worx/ALox/html/java_ref/java_ref.tag:java_ref/" href="java_ref/classcom_1_1aworx_1_1lox_1_1Lox.html#a28c3f7dfb6142e509a46adbfbd309264">Java</a> ) ).</p>
<p>This amount of loops should be more than enough for all major use cases. Even a third loop is necessary very seldom.</p>
<h1><a class="anchor" id="man_domain_substitution_config"></a>
3. Substitution Rules and External Configuration</h1>
<h2><a class="anchor" id="man_domain_substitution_config_using"></a>
3.1 Using External Configuration</h2>
<p>Setting <em>Domain Substitution</em>Rs <em>'from within the source code'</em> is easy and straightforward. However, when working in a team such changes might not be appreciated by other team members. In this and other situations it is advisable to retrieve <em>Domain Substitution</em>R from external configuration data, command-line parameters or other sources at run-time.</p>
<p>For <em>Domain Substitution</em>Rs and also other configuration data, ALox leverages the configuration facility provided by underlying utility library ALib.</p>
<dl class="section note"><dt>Note</dt><dd>For general information on ALox configuration variables consult <a class="el" href="group__GrpALoxConfigVars.html">I - Configuration Variables</a>.<br />
 For information on how to pass configuration data from custom sources to ALox, refer to namespace documentation <b>aworx::lib::config</b> (<a class="elRef" doxygen="/A-Worx/ALox/html/cpp_ref/cpp_ref.tag:cpp_ref/" href="cpp_ref/namespaceaworx_1_1lib_1_1config.html">C++</a>, <a class="elRef" doxygen="/A-Worx/ALox/html/cs_ref/cs_ref.tag:cs_ref/" href="cs_ref/namespacecs_1_1aworx_1_1lib_1_1config.html">C#</a>, <a class="elRef" doxygen="/A-Worx/ALox/html/java_ref/java_ref.tag:java_ref/" href="java_ref/namespacecom_1_1aworx_1_1lib_1_1config.html">Java</a> ) ).</dd></dl>
<p>The constructor of class <b>Lox</b> tries to read a configuration variable named <code>ALOX_LOXNAME_DOMAIN_SUBSTITUTION</code>. When setting the variable, the substring <code>'LOXNAME'</code> needs to be replaced by the name of the <b>Lox</b> in question. The variable itself may contain a list of <em>Domain Substitution</em>Rs separated by semicolons <code> ';'</code>. Each rule consists of two strings which correspond to the two parameters of method <b>Lox.SetDomainSubstitutionRule</b> (<a class="elRef" doxygen="/A-Worx/ALox/html/cpp_ref/cpp_ref.tag:cpp_ref/" href="cpp_ref/classaworx_1_1lox_1_1Lox.html#a57e92057e7a33c93ff16a677df6db52b">C++</a>, <a class="elRef" doxygen="/A-Worx/ALox/html/cs_ref/cs_ref.tag:cs_ref/" href="cs_ref/classcs_1_1aworx_1_1lox_1_1Lox.html#ad02747a6295e7875c14a77996d9728cd">C#</a>, <a class="elRef" doxygen="/A-Worx/ALox/html/java_ref/java_ref.tag:java_ref/" href="java_ref/classcom_1_1aworx_1_1lox_1_1Lox.html#a28c3f7dfb6142e509a46adbfbd309264">Java</a>). These two strings are to be separated by <code>'-&gt;'</code>.</p>
<p>As an example, an ini-File of an application might have the following sub-section:</p>
<div class="fragment"><div class="line">[ALOX]</div><div class="line">MYLOX_DOMAIN_SUBSTITUTION= /A_DOM -&gt; /BETTER_NAME   ; \</div><div class="line">                           /UI    -&gt; /LIBS/UI</div></div><!-- fragment --><p> With variable <code>ALOX_MYLOX_DOMAIN_SUBSTITUTION</code> set in the ini-File, a <b>Lox</b> named <code>'MYLOX'</code> would receive the two rules specified.</p>
<h2><a class="anchor" id="man_domain_substitution_config_prevent"></a>
3.2 Preventing The Use Of External Configuration</h2>
<p>Sometimes it might be wanted that <em>Domain Substitution</em>R are not manipulatable externally. A reason could be that by the nature of these rules, unauthorized users are enabled to change the <em>Log Domains</em> and hence also to change their <em>Verbosity</em>, which otherwise can be prevented for protection (see <a class="el" href="man_external_verbosity_configuration.html">12 - External Verbosity Configuration</a>).</p>
<p>ALox does not provide an explicit interface to prevent reading the rules from the configuration. The simple way out, is to delete all rules after the creation of the <b>lox</b>:</p>
<div class="fragment"><div class="line">myLox= <span class="keyword">new</span> <a class="codeRef" doxygen="/A-Worx/ALox/html/cpp_ref/cpp_ref.tag:cpp_ref/" href="cpp_ref/classaworx_1_1lox_1_1Lox.html">Lox</a>( <span class="stringliteral">&quot;MyLox&quot;</span> );                      <span class="comment">// name will be converted to upper case</span></div><div class="line">myLox.SetDomainSubstitutionRule( null, null );  <span class="comment">// clear rules eventually read in constructor</span></div></div><!-- fragment --><h1><a class="anchor" id="man_domain_substitution_wrapup"></a>
4. Final Remarks</h1>
<p><em>Domain Substitution</em> rules are always applied to all <em>Loggers</em> within a <b>Lox</b>.</p>
<p>As noted already, <em>Domain Substitution</em> should be used with care and in case of doubt, thought well. Different alternatives to setting a <em>Domain Substitution</em> exist. For example, to manipulate the domain of methods executed within a library, a thread-related <em>Scope Domain</em> setting may be set prior to invoking library methods.</p>
<p><em>Prefix Logables</em> that have been set for a domain that gets substituted, of-course do <em>not</em> apply to the substitution domain. In contrast, a <em>Log Statement</em> whose resulting domain gets substituted works just as it was using the new domain within its invocation and <em>Scope Domain</em> setting. Therefore, <em>Domain Substitution</em> settings - if at all - should be made at the beginning of a processes life-cycle and then should not be altered. In this case, also <em>Prefix Logables</em> will be 'transferred' to the substitution domain, providing that the commands that are setting them use relative domain paths.</p>
<hr/>
 <center>Next chapter: <a class="el" href="man_colorful_loggers.html">15 - Colorful Loggers</a> </center> <center> <a class="el" href="manual.html">Back to index</a> </center> </div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 19 2016 14:36:18 for ALox by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
